<!DOCTYPE html>
<meta charset="utf-8">
<script type="text/javascript" src="http://d3js.org/d3.v3.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">

<link href="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-bootstrap/0.5pre/css/custom-theme/jquery-ui-1.10.0.custom.css" rel="stylesheet"/>
<link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.2/css/bootstrap.css" rel="stylesheet"/>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.2/jquery-ui.js"></script>


<!-- CSS styling  -->
<style>
.slider1 {
    width: 20%;
}

.slider2 {
    width: 20%;
}

.slider3 {
    width:20%;
}
.attr1{
    color: #060558;
}
.attr2{
    color: #064da6;
}
.attr3{
    color: #01bef0;
}
path.link {
  fill: none;
  stroke: #666;
  stroke-width: 1.5px;
}

.node {
  fill: #ccc;
  stroke: #fff;
  stroke: black;
  stroke-width: 1.5px;
}


</style>

<html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
<!-- Head  -->
<head>
    <title>
        Song Recommender
    </title>
</head>

<!-- Body  -->
<body>
    <script>
        function updateSongInput() {
            songId = $('#inputSong').val()
            fetch(`/getdata/${songId}`)
                .then(response => response.text())
                .then(kSimilarSongs => {
                    console.log('GET response:');
                    console.log(kSimilarSongs);
                    $('#outputSongs').text(kSimilarSongs);
                });
        }

        // for autocomplete
        $(function() {
            // TODO load from a file containing track names instead of these placeholders
            var availableTags = [
                "ActionScript", "AppleScript", "Asp", "BASIC", "C", "C++",
                "Clojure", "COBOL", "ColdFusion", "Erlang", "Fortran",
                "Groovy", "Haskell", "Java", "JavaScript", "Lisp", "Perl",
                "PHP", "Python", "Ruby", "Scala", "Scheme"
            ];

            $(".autocomplete").autocomplete({
                source: availableTags
            });
        });


// ANNIE STARTED CODING FORCE GRAPH HERE LOL

    //sample data for nodes and edges
        var nodes = [{'song_id': 123, 'song_name': "Fireworks", 'weight': 1}, {'song_id': 20, 'song_name': "Toxic", 'weight': 0.8}]
        var nodeIDs = nodes.map(x => x['song_id'])

        var edges = [{source: 123, target: 20}]

        var width = 1000;
        var height = 600;

        // force simulation function is not defined,
        // also there isn't any html element this is being added to.  - Daniel
        var force = d3.forceSimulation()
            .nodes(d3.values(nodeIDs))
            .force("link", d3.forceLink(edges).distance(100))
            .force('center', d3.forceCenter(width / 2, height / 2))
            .force("x", d3.forceX())
            .force("y", d3.forceY())
            .force("charge", d3.forceManyBody().strength(-250))
            .alphaTarget(1)
            .on("tick", tick);

        var svg = d3.select("body").append("svg")
            .attr("width", width)
            .attr("height", height);

        var path = svg.append("g")
            .selectAll("path")
            .data(edges)
            .enter()
            .append("path")
            .attr("class", function(d) { return "link " + d.type; });

        var node = svg.selectAll(".node")
            .data(force.nodes())
            .enter().append("g")
            .attr("class", "node")
            .call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended));

        node.append("circle")
            .attr("class", "unpinned")
            .attr("r", 5);

    </script>
    <h1> Song Recommender </h1>

    <!-- <div class="form-group">
        <label>Languages</label>
        <input class="form-control autocomplete" placeholder="Enter a song" />
    </div> -->

    <!-- TODO: add autocomplete -->
    <form class="form-inline">
        <div class="form-group mx-sm-3 mb-2">
            <label for="inputSong" class="sr-only">Song Name</label>
            <input class="form-control" id="inputSong" placeholder="Song Name">
          </div>
        <button type="button" class="btn btn-primary mb-2" onclick="updateSongInput()">Update Song</button>
        <p id="outputSongs"></p>
    </form>


<div class= slider1>
    <label class = attr1>Attribute 1 Slider</label>
    <div class="d-flex justify-content-center my-4">
        <span class="font-weight-bold indigo-text mr-2 mt-1">0</span>
        <form class="range-field w-100">
            <input class="border-0" type="range" min="0" max="100" />
        </form>
        <span class="font-weight-bold indigo-text ml-2 mt-1">100</span>
    </div>
</div>

<div class= slider2>
    <label class=attr2>Attribute 2 Slider</label>
    <div class="d-flex justify-content-center my-4">
        <span class="font-weight-bold indigo-text mr-2 mt-1">0</span>
        <form class="range-field w-100">
            <input class="border-0" type="range" min="0" max="100" />
        </form>
        <span class="font-weight-bold indigo-text ml-2 mt-1">100</span>
    </div>
</div>

<div class= slider3>
    <label class = attr3>Attribute 3 Slider</label>
    <div class="d-flex justify-content-center my-4">
        <span class="font-weight-bold indigo-text mr-2 mt-1">0</span>
        <form class="range-field w-100">
            <input class="border-0" type="range" min="0" max="100" />
        </form>
        <span class="font-weight-bold indigo-text ml-2 mt-1">100</span>
    </div>
</div>


<body>
